<Window x:Class="IconSwapperGui.UI.Windows.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:IconSwapperGui.UI.Converters"
        xmlns:views="clr-namespace:IconSwapperGui.UI.Views"
        xmlns:components="clr-namespace:IconSwapperGui.UI.Views.Components"
        mc:Ignorable="d"
        Title="Template Main Window"
        Height="1000"
        Width="1500"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource AppBackgroundBrush}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- MainWindow.xaml lives in the Windows folder; SharedStyles.xaml is in the project-level Themes folder -->
                <ResourceDictionary Source="../Themes/SharedStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <!-- Converters -->
            <converters:ViewModelToViewConverter x:Key="ViewModelToViewConverter" />
            <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Grid.Column="0"
                Background="{DynamicResource SidebarBackgroundBrush}"
                BorderThickness="0,0,1,0"
                BorderBrush="{DynamicResource BorderBrush}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Logo/Title Section -->
                <Border Grid.Row="0"
                        Padding="20"
                        BorderThickness="0,0,0,1"
                        BorderBrush="{DynamicResource BorderBrush}">
                    <StackPanel>
                        <TextBlock Text="{Binding ApplicationName}"
                                   FontSize="20"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryTextBrush}" />
                        <TextBlock Text="{Binding ApplicationVersion, StringFormat=Version {0}}"
                                   FontSize="11"
                                   Foreground="{DynamicResource TertiaryTextBrush}"
                                   Margin="0,4,0,0" />
                    </StackPanel>
                </Border>

                <!-- Navigation Menu -->
                <ScrollViewer Grid.Row="1"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              Padding="0,12">
                    <StackPanel>
                        <!-- Swapper -->
                        <RadioButton Style="{StaticResource NavButtonStyle}"
                                     GroupName="Navigation"
                                     IsChecked="True"
                                     Command="{Binding NavigateToSwapperCommand}">
                            <StackPanel Orientation="Horizontal">
                                <Path Style="{StaticResource NavIconStyle}"
                                      Data="M4 7h11l-3-3 1.4-1.4L19.8 8l-6.4 6.4L12 13l3-3H4V7zm16 10H9l3 3-1.4 1.4L4.2 16l6.4-6.4L12 11l-3 3h11v3z" />
                                <TextBlock Text="Swapper"
                                           FontSize="14"
                                           FontWeight="Medium"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </RadioButton>

                        <!-- Converter -->
                        <RadioButton Style="{StaticResource NavButtonStyle}"
                                     GroupName="Navigation"
                                     Command="{Binding NavigateToConverterCommand}">
                            <StackPanel Orientation="Horizontal">
                                <Path Style="{StaticResource NavIconStyle}"
                                      Data="M4 5a1 1 0 011-1h10a1 1 0 011 1v10a1 1 0 01-1 1H5a1 1 0 01-1-1V5zm2 2v6h8V7H6zm11 1l4 4-4 4v-3h-3v-2h3V8z" />
                                <TextBlock Text="Converter"
                                           FontSize="14"
                                           FontWeight="Medium"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </RadioButton>

                        <!-- Pixel Art Editor -->
                        <RadioButton Style="{StaticResource NavButtonStyle}"
                                     GroupName="Navigation"
                                     Command="{Binding NavigateToPixelArtEditorCommand}">
                            <StackPanel Orientation="Horizontal">
                                <Path Style="{StaticResource NavIconStyle}"
                                      Data="M4 4h16v16H4V4zm2 2v4h4V6H6zm6 0v4h4V6h-4zM6 12v4h4v-4H6zm6 4v4h4v-4h-4z" />
                                <TextBlock Text="Pixel Art Editor"
                                           FontSize="14"
                                           FontWeight="Medium"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </RadioButton>

                        <!-- Settings -->
                        <RadioButton Style="{StaticResource NavButtonStyle}"
                                     GroupName="Navigation"
                                     Command="{Binding NavigateToSettingsCommand}">
                            <StackPanel Orientation="Horizontal">
                                <Path Style="{StaticResource NavIconStyle}"
                                      Data="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <TextBlock Text="Settings"
                                           FontSize="14"
                                           FontWeight="Medium"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </RadioButton>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Top Bar -->
            <Border Grid.Row="0"
                    Background="{DynamicResource SurfaceBackgroundBrush}"
                    BorderThickness="0,0,0,1"
                    BorderBrush="{DynamicResource BorderBrush}"
                    Padding="24,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- Page Title -->
                    <TextBlock Grid.Column="0"
                               Text="{Binding PageTitle}"
                               FontSize="24"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource PrimaryTextBrush}"
                               VerticalAlignment="Center" />

                    <!-- Action Buttons -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal">
                        <!-- Notification Button -->
                        <Grid>
                            <components:IconButton Command="{Binding NotificationPanel.TogglePanelCommand}" Width="40" Height="40">
                                <Path
                                    Data="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"
                                    Stroke="{DynamicResource SecondaryTextBrush}"
                                    StrokeThickness="2"
                                    Width="20"
                                    Height="20"
                                    Stretch="Uniform"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center" />
                            </components:IconButton>

                            <!-- Unread Badge -->
                            <Border Background="#EF4444"
                                    CornerRadius="10"
                                    Padding="5,2"
                                    MinWidth="20"
                                    Height="20"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Margin="0,-4,-4,0"
                                    Visibility="{Binding NotificationPanel.UnreadCount, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="{Binding NotificationPanel.UnreadCount}"
                                           FontSize="10"
                                           FontWeight="Bold"
                                           Foreground="White"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center" />
                            </Border>

                            <!-- Notification Popup -->
                            <Popup IsOpen="{Binding NotificationPanel.IsOpen, Mode=TwoWay}"
                                   StaysOpen="False"
                                   AllowsTransparency="True"
                                   Placement="Bottom"
                                   PlacementTarget="{Binding RelativeSource={RelativeSource AncestorType=Grid}}"
                                   HorizontalOffset="-360"
                                   VerticalOffset="8">
                                <views:NotificationPanelView DataContext="{Binding NotificationPanel}"
                                                             Width="400" />
                            </Popup>
                        </Grid>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Content Area (Navigation Target) -->
            <ContentControl Grid.Row="1"
                            Content="{Binding CurrentView, Converter={StaticResource ViewModelToViewConverter}}"
                            Margin="24" />
        </Grid>

        <!-- Toast Notification Overlay -->
        <Grid Grid.Column="1"
              IsHitTestVisible="False"
              Margin="0,16,16,0"
              VerticalAlignment="Top"
              HorizontalAlignment="Right">
            <components:ToastNotificationView DataContext="{Binding NotificationPanel.Toast}"
                                              Visibility="Collapsed" />
        </Grid>
    </Grid>

</Window>